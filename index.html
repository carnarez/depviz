<!doctype html><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>depviz</title><meta name=title content=depviz><meta name=description content="Visualise simple and complex dependencies online"><meta property=article:author content=carnarez><meta property=article:published_time content=2024-04-23><meta property=og:type content=article><meta property=og:url content=https://carnarez.github.io/depviz><meta property=og:title content=depviz><meta property=og:description content="Visualise simple and complex dependencies online"><meta property=og:image content=https://source.unsplash.com/1600x900/?forest><link rel=canonical href=https://carnarez.github.io/depviz><link rel=icon href=# type=image/png><link rel=stylesheet href=https://carnarez.github.io/depviz/style.css><script>function setTheme(e){localStorage.setItem("theme",e),document.documentElement.className=e}function toggleTheme(){"light"===localStorage.getItem("theme")?setTheme("dark"):"dark"===localStorage.getItem("theme")?setTheme("dimmed"):setTheme("light")}"dark"===localStorage.getItem("theme")||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?setTheme("dark"):"dimmed"===localStorage.getItem("theme")?setTheme("dimmed"):setTheme("light")</script><script>var timer;window.addEventListener("scroll",()=>{const e=document.querySelector("#scroller"),o=document.querySelector("#topbar"),r=document.querySelector("#toc"),i=document.querySelector("article");var t,l;0<e.getBoundingClientRect().top?(e.style.width="0",document.querySelectorAll("aside, article").forEach(e=>{var t=e.className.match(/visible-sidebar/)||"";0<t.length&&e.classList.remove(t)}),r.scrollTop=0):(t=window.scrollY,l=o.offsetHeight+i.offsetHeight-window.innerHeight,e.style.width=100*Math.min(t/l,1)+"%",null!==timer&&clearTimeout(timer),timer=setTimeout(()=>{var t=i.querySelectorAll("h1, h2, h3, h4, h5, h6");for(let e=0;e<t.length;e++)if(0<t[e].getBoundingClientRect().top-parseInt(getComputedStyle(document.documentElement).scrollMarginTop)-1){0===e?history.pushState({},"",window.location.pathname):history.pushState({},"","#"+t[e-1].id);break}r.querySelectorAll("a").forEach(e=>{var t=e.getAttribute("href");t.startsWith("#")&&(t===window.location.hash?(e.classList.add("active"),(e.offsetTop<r.scrollTop+o.offsetHeight||e.offsetTop>window.innerHeight-o.offsetHeight)&&(r.scrollTop=e.offsetTop-2*o.offsetHeight)):e.classList.remove("active"))})},150))}),window.onload=()=>{const r=document.querySelector("#topbar"),i=document.querySelector("#toc"),e=i.querySelectorAll("a"),l=window.location.pathname.replace(/^[/]|[/]$/g,""),t=window.location.hash,c=(e.forEach(e=>{e.setAttribute("onclick","toggleSidebar('#toc')")}),[]),o=[];e.forEach(e=>{(e.getAttribute("href").startsWith("#")?o:c).push(e)}),c.forEach((e,t)=>{var o;e.getAttribute("href").replace(/^[/]|[/]$/g,"")===l&&(e.classList.add("active"),(e.offsetTop<i.scrollTop+r.offsetHeight||e.offsetTop>window.innerHeight-r.offsetHeight)&&(i.scrollTop=e.offsetTop-2*r.offsetHeight),0<t&&(e=c[t-1],o=document.querySelector("#prev"),localStorage.setItem("prev-content",e.href),o.href=e.href,o.text=e.text),t<c.length-1)&&(o=c[t+1],e=document.querySelector("#next"),localStorage.setItem("next-content",o.href),e.href=o.href,e.text=o.text)}),o.forEach(e=>{e.getAttribute("href")===t?(e.classList.add("active"),(e.offsetTop<i.scrollTop+r.offsetHeight||e.offsetTop>window.innerHeight-r.offsetHeight)&&(i.scrollTop=e.offsetTop-2*r.offsetHeight)):e.classList.remove("active")})}</script><script>window.addEventListener("keyup",e=>{var t=document.querySelector("#scroller"),o=e.key;0===t.getBoundingClientRect().top&&"BODY"===e.srcElement.tagName&&("<"===o?window.location.href=localStorage.getItem("prev-content")||"":">"===o?window.location.href=localStorage.getItem("next-content")||"":"."===o?toggleSidebar("#toc"):"?"===o&&toggleSidebar("#search")),"INPUT"===e.srcElement.tagName&&"Escape"===o&&e.srcElement.blur()})</script><script>function toggleSidebar(e,s=void 0){var i=document.querySelector("#scroller"),o=document.querySelector("aside"+e),e=document.querySelector(`aside:not(${e})`),l=document.querySelector("article");0<i.offsetTop&&window.scroll(0,i.offsetTop),e.classList.contains("visible-sidebar")&&(e.classList.remove("visible-sidebar"),l.classList.remove("visible-sidebar")),o.classList.contains("visible-sidebar")?(o.classList.remove("visible-sidebar"),l.classList.remove("visible-sidebar"),s=void 0):(o.classList.add("visible-sidebar"),l.classList.add("visible-sidebar")),void 0!==s?document.querySelector(s).focus():document.activeElement.blur()}</script><script>function lunrSearch(){fetch("https://carnarez.github.io/depviz/index.json").then(e=>e.json()).then(e=>{const t=e.documents,r=lunr.Index.load(e.indexed),i=[],a=document.querySelector("#search-input").value,c=document.querySelector("#search-output");2<a.length?(c.innerHTML=`<li>No results for "<i>${a}</i>" in current corpus.</li>`,r.search(a).forEach(a=>{const e=t[a.ref][0],c=t[a.ref][1],n=t[a.ref][2],s=parseFloat(a.score).toFixed(3);let l="";l=""===e?""!==c?"":"/":(""!==c?e+"/":e).replaceAll("/"," &gt; "),Object.keys(a.matchData.metadata).forEach(e=>{a.matchData.metadata[e].text.position.forEach(e=>{var t=document.createElement("li"),r=parseInt(e[0]),e=parseInt(e[1]);t.innerHTML=`
                      <a class="search-result" href="https://carnarez.github.io/depviz/${a.ref}" onclick="toggleSidebar('#search')">
                        <div class="title">${l}${c}</div>
                        <div class="text">
                          ${n.slice(Math.max(0,r-100),r)}
                          <mark>${n.slice(r,r+e)}</mark>
                          ${n.slice(r+e,Math.min(r+e+100,n.length))}
                          <span class="score">${s}</span>
                        </div>
                      </a>
                    `,i.push(t)})})}),0<i.length&&c.replaceChildren(...i)):c.replaceChildren()})}function resetSearch(){var e=document.querySelector("#search-input"),t=document.querySelector("#search-output");e.value="",e.focus(),t.replaceChildren()}</script><script defer src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js onload=hljs.highlightAll()></script><script defer src=https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js></script><nav id=topbar><div><a class=sidebar onclick='toggleSidebar("#toc")'></a> <a class=search onclick='toggleSidebar("#search","#search-input")'></a> <span class=spacer></span> <span class=spacer></span> <a class=repo href=https://github.com/carnarez/depviz></a> <a class=theme onclick=toggleTheme()></a></div></nav><nav id=scroller></nav><main><aside id=toc><div class=toc><ul><li><a href=/depviz/ >Home</a><ul><li><a href=#visualisation-options>Visualisation options</a><ul><li><a href=#force-directed-graph>Force-directed graph</a><li><a href=#graphviz>Graphviz</a><li><a href=#hierarchical-edge-bundling>Hierarchical edge bundling</a><li><a href=#mermaid>Mermaid</a></ul><li><a href=#input-formats>Input formats</a><li><a href=#tooling>Tooling</a></ul><li><a href=/depviz/force-directed-graph>Force-directed graph</a><li><a href=/depviz/graphviz-graph>Graphviz</a><li><a href=/depviz/hierarchical-edge-bundling>Hierarchical edge bundling</a><li><a href=/depviz/mermaid-flowchart>Mermaid flowchart</a><li><a href=/depviz/utils>Tooling API</a></ul></div></aside><aside id=search><header><a class=search onclick='document.querySelector("#search-input").focus()'></a> <input autocomplete=off id=search-input onkeyup=lunrSearch() placeholder="search with lunr"> <a class=reset onclick=resetSearch()></a></header><ul id=search-output></ul></aside><article><div><p>This austere little set of pages is mostly for my own use as I find myself exporting (from libraries or databases) dependency trees and the likes. Instead of writing something ad-hoc each time, this page allows me to quickly visualise and demonstrate.<p>As an example, below the query to export all dependencies between materialized views within an AWS <code>Redshift</code> database: <sup id=fnref:1><a class=footnote-ref href=#fn:1>1</a></sup><pre class=highlight><code class=language-sql>select
  parent || ',' || child as "csv"
from (
  select
    ref_schema || '.' || ref_name as parent,
    "schema" || '.' || "name" as child
  from pg_catalog.stv_mv_deps
  order by 1,2
)</code></pre><p>This would output some CSV-looking list that I can directly copy/paste in the visualisation input form of these pages. Below some links to various visualisations <sup id=fnref:2><a class=footnote-ref href=#fn:2>2</a></sup> to plot such networks.<h4 id=visualisation-options>Visualisation options</h4><h5 id=force-directed-graph><a href=/depviz/force-directed-graph>Force-directed graph</a></h5><p>In 3D.<p>The most fun, if not the most practical to demonstrate. But hey, it makes people smile.<p>Based on the <a href=https://github.com/vasturiano/3d-force-graph><code>3d-force-graph</code></a> package, and the excellent series of examples around it. Itself making use of the now well-known <a href=https://github.com/mrdoob/three.js><code>three.js</code></a> and its WebGL rendering.<h5 id=graphviz><a href=/depviz/graphviz-graph><code>Graphviz</code></a></h5><p>The drawing engine written in <code>C</code>, <a href=https://graphviz.org/ ><code>Graphviz</code></a>, has now been <a href=https://hpcc-systems.github.io/hpcc-js-wasm/classes/graphviz.Graphviz.html>compiled to WASM</a> by the folks at <a href=https://hpccsystems.com/ >HPCC Systems</a>, making it usable in browsers.<p>Beware, expect old-school graphics.<h5 id=hierarchical-edge-bundling><a href=/depviz/hierarchical-edge-bundling>Hierarchical edge bundling</a></h5><p>My personal favourite to visualise multilevel dependency networks. According to the author of <a href=https://www.data-to-viz.com/ ><em>From Data to Viz</em></a>: <sup id=fnref:3><a class=footnote-ref href=#fn:3>3</a></sup><blockquote><p>Hierarchical edge bundling allows visualising adjacency relations between entities organized in a hierarchy. The idea is to bundle the adjacency edges together to decrease the clutter usually observed in complex networks.</blockquote><p>Well said.<h5 id=mermaid><a href=/depviz/mermaid-flowchart><code>Mermaid</code></a></h5><p>Following the <em>Sugiyama</em> method after the author of the original publication solving the layout optimization problem back in the days. <sup id=fnref:4><a class=footnote-ref href=#fn:4>4</a></sup><p>Graph built via <a href=https://github.com/mermaid-js/mermaid><code>Mermaid</code></a> (<a href=https://mermaid.js.org/ >docs</a>), a somewhat broader implementation of the DAG solution presented above defining its own <a href=https://mermaid.js.org/syntax/flowchart.html>syntax</a> (generated in these pages from the provided data) and based on yet another rendering engine: <a href=https://github.com/dagrejs/dagre-d3><code>dagre-d3</code></a> (now officially deprecated but still working well).<h4 id=input-formats>Input formats</h4><p>Most of these litle tools accept data in the following formats: CSV in which each line carries a pair of <code>parent,child</code> or <code>child,parent</code>:<pre class=highlight><code class=language-csv>parent,child
parent,child
...</code></pre><p>or JSON in which a list of children is provided for each parent, or a list of parents for each child:<pre class=highlight><code class=language-json>{
  parent: [
    child,
    child,
    ...
  ],
  parent : [
    ...
  ],
  ...
}</code></pre><p>Look for the buttons to precise which input format is provided to avoid swaping up the colour coding. And let's keep it consistent, no mixing between the formats in the same file.<p>Most of these representation colour parent link(s) / node(s) in blue, and child link(s) / node(s) in red.<h4 id=tooling><a href=/depviz/utils>Tooling</a></h4><p>Also available in this repo, some small <code>Python</code> utils to extract information from SQL queries or convert tabular CSV content to the JSON input some of the visualisations expect. Run via:<pre class=highlight><code class=language-shell>$ make env
&gt; python utils/csv_to_json.py &lt;CSV FILE&gt;  # for instance</code></pre><p>Again, this works for <em>me</em> and my current projects! No other claims nor guarantees.<div class=footnote><hr><ol><li id=fn:1><p>Here is a <a href=https://aws.amazon.com/redshift/ >link</a> to avoid lawsuits; not an advertisement though, simply what I am currently working with.&#160;<a class=footnote-backref href=#fnref:1 title="Jump back to footnote 1 in the text"></a><li id=fn:2><p>Mostly done using <a href=https://d3js.org/ >D3</a> because this library rocks, and the SVG format is fun to work with.&#160;<a class=footnote-backref href=#fnref:2 title="Jump back to footnote 2 in the text"></a><li id=fn:3><p>The quote from the <a href=https://www.data-to-viz.com/graph/edge_bundling.html>source</a>.&#160;<a class=footnote-backref href=#fnref:3 title="Jump back to footnote 3 in the text"></a><li id=fn:4><p><em>Methods for Visual Understanding of Hierarchical System Structures</em> by Sugiyama <em>et al.</em>, 1981&#160;<a class=footnote-backref href=#fnref:4 title="Jump back to footnote 4 in the text"></a></ol></div></div><span class=spacer></span><footer><a id=prev></a> <span class=spacer></span> <a id=next></a></footer></article></main>